<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compteur de Calorie en Ligne</title>
    <style>
        body {
            background: url('https://img.freepik.com/photos-premium/salle-sport-sombre-lumiere-rouge-bas-ecran_911201-3384.jpg') no-repeat center center fixed;
            background-size: cover;
            color: rgb(236, 38, 32); /* Modification de la couleur du texte */
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        header {
            background: rgba(26, 26, 26, 0.8);
            padding: 20px;
            text-align: center;
            font-size: 2em;
            color: rgb(236, 38, 32); /* Modification de la couleur du texte */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        .account-count {
            background: rgba(51, 51, 51, 0.8);
            padding: 10px;
            border-radius: 5px;
            color: rgb(236, 38, 32); /* Modification de la couleur du texte */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            text-align: center;
            margin-bottom: 10px;
            font-size: 1em;
        }
        .container {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .section {
            background: rgba(51, 51, 51, 0.8);
            padding: 20px;
            margin: 20px 0;
            display: none;
            width: 100%;
            max-width: 500px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        .section.active {
            display: block;
        }
        label, input, select {
            display: block;
            margin: 10px 0;
            width: 100%;
        }
        input, select {
            padding: 10px;
            border: none;
            border-radius: 5px;
            background: #444;
            color: rgb(236, 38, 32); /* Modification de la couleur du texte */
        }
        button {
            background: #EC2620; /* Modification de la couleur du bouton */
            border: none;
            padding: 10px 20px;
            color: black; /* Modification de la couleur du texte */
            cursor: pointer;
            border-radius: 5px;
            text-align: center; /* Centrer le texte */
            transition: background 0.3s;
        }
        button:hover {
            background: #d81b60; /* Slightly darker shade for hover effect */
        }
        .message {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            width: 100%;
            text-align: center;
        }
        .error {
            background: #EC2620;
            color: black; /* Modification de la couleur du texte */
        }
        .success {
            background: #EC2620;
            color: black; /* Modification de la couleur du texte */
        }
        footer {
            background: rgba(26, 26, 26, 0.8);
            text-align: center;
            padding: 10px;
            color: rgb(236, 38, 32); /* Footer text color red */
            box-shadow: 0 -4px 8px rgba(0, 0, 0, 0.3);
        }
        canvas {
            width: 100% !important;
            max-width: 600px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #444;
            padding: 10px;
            text-align: center;
        }
        th {
            background: #444;
        }
        td button {
            background: #EC2620; /* Modification de la couleur du bouton de suppression */
            color: black; /* Modification de la couleur du texte */
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        Compteur de Calorie en Ligne
    </header>
    <div class="container">
        <div class="account-count" id="accountCount">0 comptes existants</div>
        <div id="login" class="section active">
            <h2>Connexion</h2>
            <label for="loginPseudo">Pseudo :</label>
            <input type="text" id="loginPseudo">
            <label for="loginPassword">Mot de passe :</label>
            <input type="password" id="loginPassword">
            <button onclick="login()">Se connecter</button>
            <button onclick="showSection('register')">Créer un compte</button>
            <div id="loginMessage" class="message"></div>
        </div>
        <div id="register" class="section">
            <h2>Inscription</h2>
            <label for="registerPseudo">Pseudo :</label>
            <input type="text" id="registerPseudo">
            <label for="registerPassword">Mot de passe :</label>
            <input type="password" id="registerPassword">
            <button onclick="register()">Créer un compte</button>
            <button onclick="showSection('login')">Retour à la connexion</button>
            <div id="registerMessage" class="message success">Inscription réussie. Vous pouvez maintenant vous connecter.</div>
        </div>
        <div id="menu" class="section">
            <h2>Menu Principal</h2>
            <button onclick="showSection('calcul')">Calculer les calories</button>
            <button onclick="showSection('graphique')">Voir l'évolution</button>
            <button onclick="deleteAccount()">Supprimer le compte</button>
            <button onclick="logout()">Déconnexion</button>
            <div id="menuMessage" class="message"></div>
        </div>
        <div id="calcul" class="section">
            <h2>Calcul des Calories</h2>
            <label for="regime">Choisissez votre régime :</label>
            <select id="regime">
                <option value="1">Prise de masse</option>
                <option value="2">Sèche</option>
                <option value="3">Maintenance</option>
            </select>
            <div id="surplusDeficit">
                <label id="labelSurplusDeficit" for="calories">De combien de calories voulez-vous être en <span id="surplusDeficitText">surplus</span> ?</label>
                <input type="number" id="calories">
            </div>
            <label for="caloriesBrulees">Combien de calories votre Apple Watch indique-t-elle que vous avez brûlées aujourd'hui ?</label>
            <input type="number" id="caloriesBrulees">
            <label>Avez-vous fait de la musculation aujourd'hui ?</label>
            <input type="radio" id="muscuOui" name="musculation" value="oui">
            <label for="muscuOui">Oui</label>
            <input type="radio" id="muscuNon" name="musculation" value="non" checked>
            <label for="muscuNon">Non</label>
            <div id="detailsMuscu" style="display: none;">
                <label for="caloriesMuscu">Combien de calories avez-vous brûlées pendant la séance de musculation ?</label>
                <input type="number" id="caloriesMuscu">
                <label for="dureeMuscu">Quelle était la durée de la séance de musculation en minutes ?</label>
                <input type="number" id="dureeMuscu">
                <label for="poids">Quel est votre poids (kg) ?</label>
                <input type="number" id="poids">
            </div>
            <button onclick="calculerCalories()">Calculer</button>
            <p id="resultat"></p>
            <button onclick="showSection('menu')">Retour au menu</button>
            <div id="calculMessage" class="message"></div>
        </div>
        <div id="graphique" class="section">
            <h2>Évolution des Données</h2>
            <canvas id="graphiqueCalories"></canvas>
            <canvas id="graphiquePoids"></canvas>
            <canvas id="graphiqueDuree"></canvas>
            <canvas id="graphiqueSurplusDeficit"></canvas>
            <table id="tableHistorique">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Calories Totales</th>
                        <th>Calories Brûlées</th>
                        <th>Calories Muscu</th>
                        <th>Durée Muscu</th>
                        <th>Poids</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
            <button onclick="showSection('menu')">Retour au menu</button>
        </div>
    </div>
    <footer>
        &copy; 2024 Compteur de Calorie en Ligne. Mathis Grand tous droits réservés.
    </footer>
    <script>
        let users = JSON.parse(localStorage.getItem('users')) || [];
        let currentUser = localStorage.getItem('currentUser');

        function updateAccountCount() {
            document.getElementById('accountCount').innerText = `${users.length} comptes existants`;
        }

        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
        }

        function login() {
            const pseudo = document.getElementById('loginPseudo').value;
            const password = document.getElementById('loginPassword').value;
            const user = users.find(user => user.pseudo === pseudo && user.password === password);

            if (user) {
                currentUser = pseudo;
                localStorage.setItem('currentUser', currentUser);
                showSection('menu');
            } else {
                document.getElementById('loginMessage').innerText = 'Pseudo ou mot de passe incorrect';
                document.getElementById('loginMessage').classList.add('error');
            }
        }

        function register() {
            const pseudo = document.getElementById('registerPseudo').value;
            const password = document.getElementById('registerPassword').value;

            if (users.find(user => user.pseudo === pseudo)) {
                document.getElementById('registerMessage').innerText = 'Ce pseudo est déjà pris';
                document.getElementById('registerMessage').classList.add('error');
            } else {
                users.push({ pseudo, password });
                localStorage.setItem('users', JSON.stringify(users));
                updateAccountCount();
                document.getElementById('registerMessage').innerText = 'Inscription réussie. Vous pouvez maintenant vous connecter.';
                document.getElementById('registerMessage').classList.add('success');
                document.getElementById('registerPseudo').value = '';
                document.getElementById('registerPassword').value = '';
            }
        }

        function deleteAccount() {
            users = users.filter(user => user.pseudo !== currentUser);
            localStorage.setItem('users', JSON.stringify(users));
            updateAccountCount();
            logout();
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            showSection('login');
        }

        function calculerCalories() {
            const regime = document.getElementById('regime').value;
            const calories = parseInt(document.getElementById('calories').value);
            const caloriesBrulees = parseInt(document.getElementById('caloriesBrulees').value);
            const faitMuscu = document.querySelector('input[name="musculation"]:checked').value === 'oui';

            let totalCalories = caloriesBrulees;

            if (faitMuscu) {
                const caloriesMuscu = parseInt(document.getElementById('caloriesMuscu').value);
                const dureeMuscu = parseInt(document.getElementById('dureeMuscu').value);
                const poids = parseInt(document.getElementById('poids').value);

                const caloriesSupp = (dureeMuscu / 60) * (0.1 * poids);
                totalCalories += caloriesMuscu + caloriesSupp;
            }

            if (regime == 1) {
                totalCalories += calories;
            } else if (regime == 2) {
                totalCalories -= calories;
            }

            document.getElementById('resultat').innerText = `Votre apport calorique total est de ${totalCalories} calories.`;
        }

        updateAccountCount();
        showSection('login');
    </script>
</body>
</html>
